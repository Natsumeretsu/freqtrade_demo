# SimpleMVPStrategy 回测报告

**回测日期**: 2026-01-19
**策略版本**: 基于波动率因子的简单策略
**数据范围**: 2024-01-01 至 2024-01-31 (BTC/USDT:USDT, 5分钟)

---

## 一、策略配置

### 使用的因子
- `bb_width_20`: 布林带宽度因子 (IC=0.0245, t_stat=11.37)
- `hist_vol_20`: 历史波动率因子 (IC=0.0243, t_stat=11.27)
- `keltner_width_20`: Keltner 通道宽度因子 (IC=0.0202, t_stat=9.37)

### 交易逻辑
- **入场**: 波动率因子平均值 > 滚动 100 期的 70% 分位数
- **出场**: 波动率因子平均值 < 滚动 100 期的 30% 分位数
- **止盈**: 5%
- **止损**: -3%

---

## 二、回测结果摘要

| 指标 | 值 |
|------|-----|
| **总收益** | -2.58% (-25.798 USDT) |
| **交易次数** | 88 笔 (日均 3.03 笔) |
| **胜率** | 43.2% (38 胜 / 50 负) |
| **夏普比率** | -3.38 ❌ |
| **Sortino 比率** | -4.98 ❌ |
| **最大回撤** | -7.10% (72.35 USDT) |
| **盈亏比** | 0.83 (< 1.0) ❌ |
| **期望值** | -0.29 USDT/笔 |

---

## 三、详细分析

### 3.1 出场原因分析

| 出场原因 | 交易数 | 平均收益% | 总收益 USDT | 胜率 |
|---------|--------|----------|------------|------|
| ROI (5% 止盈) | 3 | +5.0% | +47.874 | 100% ✅ |
| 出场信号 | 76 | +0.03% | +7.986 | 44.7% |
| 止损 (-3%) | 8 | -3.1% | -81.670 | 0% ❌ |
| 强制出场 | 1 | 0.0% | +0.012 | 100% |

**关键发现**:
- 止损触发 8 次，全部亏损，累计 -81.67 USDT（占总亏损的 316%）
- 止盈触发仅 3 次，但贡献 +47.87 USDT
- 大部分交易（76 笔）通过出场信号退出，平均收益接近 0

### 3.2 时间分布

- **回测周期**: 2024-01-01 08:20 至 2024-01-31 00:00 (29.7 天)
- **平均持仓时间**: 3小时54分钟
- **最长连胜**: 4 笔
- **最长连亏**: 10 笔 ⚠️

### 3.3 资金曲线

- **起始资金**: 1000 USDT
- **最终资金**: 974.202 USDT
- **最高点**: 1019.042 USDT (+1.9%)
- **最低点**: 946.692 USDT (-5.3%)
- **回撤持续时间**: 13 天 20 小时 45 分钟

---

## 四、问题诊断

### 4.1 策略失效的可能原因

1. **因子-策略不匹配**
   - 因子评估使用的是 **8 期（40 分钟）预测**
   - 策略使用的是 **5 分钟 K 线**，持仓时间 3-4 小时
   - **时间尺度不匹配**：因子预测 40 分钟收益，但策略持仓 4 小时

2. **入场阈值过于激进**
   - 使用 70% 分位数作为入场阈值
   - 导致频繁交易（88 笔/月）
   - 高频交易放大了手续费成本

3. **止损设置不合理**
   - 3% 止损在高波动率环境下容易被触发
   - 8 次止损全部亏损，说明止损点设置在噪音区间

4. **缺少市场状态过滤**
   - 波动率因子在所有市场状态下都入场
   - 未区分趋势市 vs 震荡市

### 4.2 与因子评估结果的对比

| 指标 | 因子评估 | 回测结果 | 差异 |
|------|---------|---------|------|
| 预测周期 | 8 期 (40 分钟) | 持仓 3-4 小时 | ❌ 不匹配 |
| IC 值 | 0.024 (正相关) | 总收益 -2.58% | ❌ 方向相反 |
| 样本数 | 215,591 条 | 88 笔交易 | ⚠️ 样本量小 |

---

## 五、改进建议

### 5.1 短期修复 (P0)

1. **调整时间尺度**
   - 将策略 timeframe 改为 15m 或 1h
   - 或者使用 1 期预测的因子（而非 8 期）

2. **降低交易频率**
   - 提高入场阈值至 80% 或 90% 分位数
   - 添加冷却期（避免频繁进出）

3. **优化止损**
   - 将止损放宽至 -5% 或 -7%
   - 或使用 ATR 动态止损

### 5.2 中期优化 (P1)

1. **添加市场状态过滤**
   - 只在趋势市入场（使用 ADX 或趋势强度因子）
   - 震荡市降低仓位或不交易

2. **因子组合优化**
   - 当前 3 个因子都是波动率类，相关性高
   - 添加负相关因子（如 `price_to_sma_20`）

3. **动态参数调整**
   - 根据市场波动率动态调整止盈止损
   - 高波动率时放宽止损，低波动率时收紧

### 5.3 长期研究 (P2)

1. **样本外测试**
   - 使用 2024 年 2-3 月数据验证
   - 检验策略是否过拟合

2. **参数优化**
   - 使用 Hyperopt 优化入场/出场阈值
   - 优化止盈止损参数

3. **机器学习增强**
   - 使用 FreqAI 训练因子权重
   - 自动学习最优入场时机

---

## 六、结论

**当前策略不可用于实盘交易**，主要问题：

1. ❌ **负收益**: -2.58%，跑输市场（市场涨幅 +1.13%）
2. ❌ **高风险**: 夏普比率 -3.38，Sortino -4.98
3. ❌ **高回撤**: 最大回撤 7.10%，持续 13 天
4. ❌ **低胜率**: 43.2%，且盈亏比 < 1

**根本原因**: 因子评估与策略实现的时间尺度不匹配。因子针对 40 分钟预测优化，但策略在 5 分钟级别交易。

**下一步行动**:
1. 修改策略使用 15m 或 1h timeframe
2. 重新回测验证
3. 如仍不理想，考虑使用 1 期预测的因子

---

**报告生成**: 2026-01-19
**策略文件**: [SimpleMVPStrategy.py](ft_userdir/strategies/SimpleMVPStrategy.py)
**配置文件**: [config_backtest.json](ft_userdir/config_backtest.json)
