# 动量回调（Momentum Pullback）策略模式基底（v1）

更新日期：2026-01-11

本文档用于把参考资料中的“动量回调”交易思想提炼为**可复用、可落地、可回测**的策略模式，作为后续策略实现（含 Freqtrade / FreqAI）的设计基底。

---

## 1) 来源与证据

- 本仓库参考文档：`docs/archive/strategies_ref_docs/动量讨价还价策略Momentum-Pullback-Strategy.md`
- 原始页面（FMZ）：https://www.fmz.com/strategy/440057
- 参考脚本（PineScript）要点：以 `EMA(5)` 为核心（注意：部分中文简介写成 `SMA(5)`，但源码为 `EMA(5)`；本基底以源码为准）。

---

## 2) 策略定位（它能指导哪些方向）

该模式属于“**趋势/动量（CTA）方向的回调入场**”，核心是：用短周期均线做体制边界，用上一根“信号 K 线”的极值做风控锚点，用固定风险回报比定义止盈。

适合指导的方向：

- **CTA / 趋势跟踪（主适用）**：短周期动量切换 + 固定 RR 的单笔交易结构。
- **FreqAI 的 Meta-Labeling（可选增强）**：把该模式作为“基础信号（events）”，再用 TB/分类器判断“是否值得执行”，降低震荡期噪声。

不适合直接指导的方向：

- **网格**：网格核心是区间与挂单层级，该模式是单次趋势交易结构。
- **纯均值回归**：该模式的“回调”是趋势内回撤，并非逆势抄底/摸顶。

---

## 3) 核心交易规则（以源码为准）

### 3.1 指标

- `ema5 = EMA(close, 5)`

### 3.2 入场信号（长/短对称）

以 `t` 为当前 K 线，`t-1` 为信号 K 线：

- **做空（Short）**：  
  - `low[t-1] > ema5[t-1]`（信号 K 线在均线之上）  
  - `low[t] < low[t-1]`（当前 K 线向下破位）  
  - 可选过滤（“收盘价条件”）：`close[t] < close[t-1]`

- **做多（Long）**：  
  - `high[t-1] < ema5[t-1]`（信号 K 线在均线之下）  
  - `high[t] > high[t-1]`（当前 K 线向上破位）  
  - 可选过滤（“收盘价条件”）：`close[t] > close[t-1]`

> 说明：源码里并没有强制要求 `close[t]` 穿越均线，而是用“上一根在均线一侧 + 当前破位上一根极值”来表达动量切换。

### 3.3 止损与止盈（固定 RR）

参数（来自参考脚本）：

- `RiRe`：Risk/Reward Ratio（默认 3）
- `Eusl`：是否启用“额外止损点数”
- `usl`：额外止损点数（默认 5；在加密资产上建议改为 ATR/百分比口径，见 4.2）
- `BSWCon`：是否启用“收盘价条件”（影响止盈锚点与风险基准）

**做多（Long）**

- 止损（SL）：`low[t-1]`（启用额外点数则为 `low[t-1] - usl`）
- 止盈（TP）锚点与距离：
  - 若 `BSWCon=false`：以信号 K 线振幅为风险基准：`range = high[t-1] - low[t-1]`（启用额外点数则 `range += usl`）  
    `TP = high[t-1] + range * RiRe`
  - 若 `BSWCon=true`：以当前收盘价与信号低点之差为风险基准：`range = close[t] - low[t-1]`（启用额外点数则 `range += usl`）  
    `TP = close[t] + range * RiRe`

**做空（Short）**

- 止损（SL）：`high[t-1]`（启用额外点数则为 `high[t-1] + usl`）
- 止盈（TP）锚点与距离：
  - 若 `BSWCon=false`：`range = high[t-1] - low[t-1]`（启用额外点数则 `range += usl`）  
    `TP = low[t-1] - range * RiRe`
  - 若 `BSWCon=true`：`range = high[t-1] - close[t]`（启用额外点数则 `range += usl`）  
    `TP = close[t] - range * RiRe`

### 3.4 出场

- 触达 SL → 平仓
- 触达 TP → 平仓

---

## 4) 工程化落地建议（针对加密期货）

### 4.1 适用边界（必须写清）

- 该模式在**震荡盘**容易频繁反复触发，造成“止损追击/过度交易”。  
  建议至少叠加一种体制过滤（例如更高周期趋势、ADX、波动率门控）再上实盘。

### 4.2 参数口径改造（避免“点数 usl”失真）

参考脚本的 `usl` 是“点数”，在加密资产/不同币价上不可比。建议改为：

- `usl = ATR(14) * k`（例如 `k=0.2~0.5`），或
- `usl = close * pct`（例如 `pct=0.1%~0.5%`）

并在回测报告中固定写清口径（避免同名参数含义漂移）。

### 4.3 与 FreqAI 的结合（自然演进路径）

建议把该模式当作“基础信号”，让模型只做一件事：**过滤噪声**。

- events：用 3.2 的入场规则生成 `enter_long/enter_short`
- labels：对 events 做 TB/固定 RR 标签（例如 3.3 的 SL/TP + 垂直时间障碍）
- inference：用分类器输出概率门控（例如“long 概率 > 阈值 且 概率优势足够”才执行）

这样能把“原始技术指标策略在震荡期的噪声问题”转化为可学习的过滤任务，而不是去做难度极高的连续收益回归预测。

---

## 5) 最小验证清单（建议）

- 先在单币对（例如 BTC/USDT:USDT）上做回测，观察：
  - 触发频率是否过高（震荡期噪声）
  - RR=3 的 TP 是否现实（是否长期到不了导致止损先触发）
  - 不同 timeframe 下信号稳定性
- 汇报口径：`docs/guidelines/backtest_reporting_standard.md`
